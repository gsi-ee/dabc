<?xml version="1.0"?>
<dabc version="1">
  <Variables>
  <!--Enter the values for specific setup-->
  <ctrl value="Linux controller node"/>
     <mbs1 value="MBS  readout node"/>
     <mbs2 value="MBS  readout node"/>
     <read1 value="DABC  readout node"/>
     <read2 value="DABC  readout node"/>
     <eb1 value="DABC  event builder node"/>
     <eb2 value="DABC  event builder node"/>
     <bufsize value="65536"/>
     <custport value="6000"/>
  </Variables>
  <!--Configure controller node-->
  <Context host="${ctrl}" name="Controller">
    <Run>
      <lib value="${DABCSYS}/lib/libDabcBnet.so"/>
      <runfunc value="RunTestBnet"/>
    </Run>
    <Application class="bnet::Cluster">
       <NetDevice value="dabc::SocketDevice"/>
       <CtrlBuffer value="2048"/>
       <TransportBuffer value="${bufsize}"/>
       <NumEventsCombine value="1"/>
    </Application>
  </Context>
  <!--Configure readout node-->
  <Context host="${read1}" name="Read_${mbs1}">
    <Application class="bnet::MbsWorker">
       <NumReadouts value="1"/>
       <Input0Cfg value="${mbs1}"/>
    </Application>
  </Context>
  <!--Configure readout node-->
  <Context host="${read2}" name="Read_${mbs2}">
    <Application class="bnet::MbsWorker">
       <NumReadouts value="1"/>
       <Input0Cfg value="${mbs2}"/>
    </Application>
  </Context>
  <!--Configure event builder node-->
  <Context host="${eb1}" name="Builder1"/>
  <!--Configure event builder node-->
  <Context host="${eb2}" name="Builder2"/>
  <!--Set default values for contexts-->
  <Defaults>
     <Context name="*">
       <Run>
          <logfile value="${Context}.log"/>
          <loglevel value="1"/>
       </Run>
       <Module name="*">
          <Ratemeter name="Data*" lower="0" upper="20"/>
          <Ratemeter name="Event*" lower="0" upper="20000"/>
       </Module>
     </Context>
     <Context name="Read*">
        <Run>
          <lib value="libDabcBnet.so"/>
          <lib value="libDabcMbs.so"/>
          <lib value="libBnetMbs.so"/>
        </Run>
        <Application class="bnet::MbsWorker">
           <IsSender value="true"/>
           <ReadoutBuffer value="${bufsize}"/>
        </Application>
        <Module name="Combiner">
           <Port name="Input*">
              <MbsServerPort value="${custport}"/>
           </Port>
        </Module>
     </Context>
     <Context name="Build*">
        <Run>
          <lib value="libDabcBnet.so"/>
          <lib value="libDabcMbs.so"/>
          <lib value="libBnetMbs.so"/>
        </Run>
        <Application class="bnet::MbsWorker">
           <IsReceiver value="true"/>
           <IsFilter value="false"/>
           <EventBuffer value="${bufsize}"/>
        </Application>
     </Context>
  </Defaults>
</dabc>
