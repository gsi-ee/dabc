<?xml version="1.0"?>
<dabc version="2">
  <Context host="localhost" name="EventBuilder">
    <Run>
      <lib value="libDabcMbs.so"/>
      <lib value="libDabcHadaq.so"/>  
      <func value="InitHadaqEvtbuilder"/>
      <logfile value="hadaqevtbuild.log"/>
      <loglimit value="1000000"/>
    </Run>
  
    <MemoryPool name="Pool">
       <BufferSize value="200000"/>
       <NumBuffers value="1000"/>
    </MemoryPool>
    
    <Module name="Combiner" class="hadaq::CombinerModule">    
        <!-- these parameters will force to create inputs/oputputs of module -->
       <NumInputs value="5"/>
       <NumOutputs value="1"/>
       <DoServer value="true"/>
       <DoFile value="false"/>

       <InputPort name="Input0" url="hadaq://host:10101"/>
       <InputPort name="Input1" url="hadaq://host:10102"/>
       <InputPort name="Input2" url="hadaq://host:10103"/>
       <InputPort name="Input3" url="hadaq://host:10104"/>
       <InputPort name="Input4" url="hadaq://host:10105"/>
       
       <InputPort name="Input*" queue="10">
          <HadaqUdpBuffer value="200000"/>
          <DoShmControl value="false"/>  
          <HadaqUdpMTU value="64512"/>
          <FlushTimeout value="2.0"/>   
       </InputPort>
       <OutputPort name="Output0" queue="20"/>
       <OutputPort name="Output1" url="hld://dabc.hld?maxsize=30"/>
       
       <DoShmControl value="false"/>  
       <FlushTimeout value="2.0"/>   

       <!-- take event sequence number from vulom/roc sync message at cts -->
       <UseSyncSequenceNumber value="false"/>
       <SyncSubeventId value="0x8000"/>
       <SyncTriggerMask value="0x01"/>
       <PrintSync value="false"/>
       <FlushBySync value="false"/>

       <!-- rate meters configuration -->
       <HadaqData width="4" prec="2" low="0" up="10" debug="1"/>
       <HadaqEvents width="5" prec="1" low="0" up="1000" debug="1"/>
       <HadaqDroppedData width="5" prec="3" low="0" up="1" debug="1"/>
       <HadaqLostEvents width="4" prec="2" low="0" up="100" debug="1"/>
     </Module>
     
     <Module name="OnlineServer" class="hadaq::MbsTransmitterModule">
       <NumInputs value="1"/>
       <NumOutputs value="1"/>
       <OutputPort name="Output0" url="mbs://Stream"/>
       <OutputPort name="Output1" url="lmd://test.lmd?maxsize=30&log=2"/>

       <SubeventFullId value="0x000001F"/>
       <DoMergeSyncedEvents value="true"/>
       <PrintSync value="false"/>
       
       <TransmitData width="5" prec="3" low="0" up="50" debug="1"/>
       <TransmitEvents width="4" prec="1" low="0" up="100" debug="1"/>
     </Module>
     
  </Context>
</dabc>
