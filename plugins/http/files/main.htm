<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>

   <meta http-equiv="X-UA-Compatible" content="IE=Edge; text/html">
   <title>Objects hierarchy</title>
   
   <link rel="shortcut icon" href="/httpsys/img/dabc.ico">

   <script src="/jsrootsys/scripts/JSRootCore.js" type="text/javascript" ></script>
   
   <script type='text/javascript'>
   
      function createGUI() {
            var guiCode =
                 '<div id="left-div" class="column">'+
                 '  <h2>Objects hierarchy</h2>'+
                 "  <p><font face='Verdana' size='1px'><a href='http://root.cern.ch/js/jsroot.html'>JSROOT</a> version <span style='color:green'><b>" + JSROOT.version + "</b></span></font></p>" + 
                 '  Hierarchy in <a href="h.json">json</a> and <a href="h.xml">xml</a> format<br/>'+
                 '  <div id="fast_buttons"></div><br/>'+        
                 '  <input type="checkbox" name="monitoring" id="monitoring"/> Monitoring'+        
                 '  <input type="checkbox" name="show_history" id="show_history"/> History'+
                 '  <input id="grid_spinner" style="width:60px" value="2"/>' +    
                 '  <div id="dabc_tree_holder"> </div>' +
                 '</div>'+
                 '<div id="separator-div" class="column"></div>' +
                 '<div id="right-div" class="column"></div>';
                 
            $("#mainGUI").empty();     
            $("#mainGUI").append(guiCode);
                 
         
            $("#grid_spinner").spinner({
               min:1, max:5,
               spin: function( event, ui ) { h.SetDisplay('grid'+ui.value,'right-div'); }
            }); 
         
            var h = new DABC.HierarchyPainter("dabc", "dabc_tree_holder");
            
            var monitor = JSROOT.GetUrlOption("monitoring");
            
            if (monitor) {
               document.getElementById("monitoring").checked = true;
               document.getElementById("monitoring").disabled = "disabled";
            } 
               
            if (h.HistoryDepth(true) >=0) {
               document.getElementById("show_history").checked = true;
               document.getElementById("show_history").disabled = "disabled";
            }
            
            var itemsarr = [], optionsarr = [];
            var itemname = JSROOT.GetUrlOption("item");
            if (itemname) itemsarr.push(itemname);
            var items = JSROOT.GetUrlOption("items");
            if (items!=null) {
               items = JSON.parse(items);
               for (var i in items) itemsarr.push(items[i]);
            }

            var opt = JSROOT.GetUrlOption("opt");
            if (opt) optionsarr.push(opt);
            var opts = JSROOT.GetUrlOption("opts");
            if (opts!=null) {
               opts = JSON.parse(opts);
               for (var i in opts) optionsarr.push(opts[i]);
            }
            
            h.SetDisplay('grid2x2', 'right-div');
            
            h.OpenOnline("", function() {
               h.displayAll(itemsarr, optionsarr);
            });
            
            h.EnableMonitoring(monitor!=null);
            $("#monitoring")
               .prop('checked', monitor!=null)
               .click(function() {
                  h.EnableMonitoring(this.checked);
                  if (this.checked) h.UpdateDabcElements();
               });
         
            setInterval(function() { h.UpdateDabcElements(); }, h.MonitoringInterval());
            
            JSROOT.RegisterForResize(h);
            
            function adjustSize(left) {
               var diff = $("#left-div").outerWidth() - $("#left-div").width();
               $("#separator-div").css('left', left.toString() + "px");
               $("#left-div").width(left-diff-1);
               $("#right-div").css('left',(left+4).toString() + "px");
               h.CheckResize();
            }

            $("#separator-div").draggable({
               axis: "x" , zIndex: 100, cursor: "ew-resize",
               helper : function() { return $("#separator-div").clone().css('background-color','grey'); },
               stop: function(event,ui) { adjustSize(ui.position.left); }
            });

            var w0 = Math.round($(window).width() * 0.2);
            if (w0<300) w0 = Math.min(300, Math.round($(window).width() * 0.5));
            adjustSize(w0);
       }

   </script>
</head>

<body onload="JSROOT.AssertPrerequisites('2d;user:/httpsys/files/dabc.css;/httpsys/scripts/dabc.js;', createGUI, 'mainGUI')">
   <div id="mainGUI">
      loading scripts ...
   </div>
</body>
</html>

