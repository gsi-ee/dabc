<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>

   <meta http-equiv="X-UA-Compatible" content="IE=Edge; text/html">

   <title>Demonstrator of online usage of JSROOT</title>

   <!--  load JSROOT with 2D graphic -->
   <script src="../scripts/JSRootCore.js?2d&onload=startGUI" type="text/javascript"></script>

   <script type='text/javascript'>

      var painter = null;
      var mdi = null;
      var cnt = 0;
      var drawopt = null;
      var addr = null;

      function updateGUI() {

         // here set of generated json files are used
         // One could specify addres of running THttpServer like http://localhost:8080/Canvases/c1/root.json.gz?compact=3
         // Or one can create root.json file in the application and place it on the webserver 
         // "dummy=xxxx" parameter used to prevent browser cashing
         // To run demo, one should generate rootXX.json files using demo.C macro

         var request_addr = "root" + (cnt%20) + ".json?dummy=" + cnt;
         cnt++;

         if (addr!=null) request_addr = addr; 

         var req = JSROOT.NewHttpRequest(request_addr, 'object', function(histo) {
            if (!histo) {
               if (!painter && !mdi) $('#drawing').append("<h3>Can not get " + request_addr + " from the server</h3>"); 
               return;
            }

            if (mdi!=null) {
               mdi.Draw('abstract_item_name_' + cnt, histo, drawopt); 
            } else { 
               painter = JSROOT.redraw('drawing', histo, drawopt);
            } 
          });

          req.send(null); 
      }

      function startGUI() {
         $('html').css('height','100%');
         $('body').css('min-height','100%').css('margin','0px').css("overflow", "hidden");

         var monitor = JSROOT.GetUrlOption("monitoring");
         if ((monitor == "") || (monitor==null)) 
            monitor = 1000;
         else
            monitor = parseInt(monitor);

         drawopt = JSROOT.GetUrlOption("opt");

         addr = JSROOT.GetUrlOption("addr");

         var layout = JSROOT.GetUrlOption("layout");
         if (layout!=null) mdi = new JSROOT.GridDisplay('drawing', layout);   

         setInterval(updateGUI, monitor);

         JSROOT.RegisterForResize(function() { if (painter) painter.CheckResize(); if (mdi) mdi.CheckResize(); });
      }
   </script>

</head>

<body>
   <div id="drawing" style="position:absolute; left:1px; top:1px; bottom:1px; right:1px"></div>
</body>

</html>

